{"components/doogma-pack/session-pack/session-management":"<!-- variable used to enable session storage are below -->\r\n\r\n<!-- sessionInclude: 'yes', -->\r\n<!-- sessionStoreModifiers: 'dp_printcolor|dp_text' -->\r\n\r\n<script>\r\n\r\n    function storeDoogmaParamsInStorage( data ) {    \r\n        // Check if localStorage is available; if not, use sessionStorage\r\n        const storage = typeof localStorage !== \"undefined\" ? localStorage : sessionStorage;\r\n        // alert(storage);\r\n        \r\n        console.log(\"session storage function consoles\")\r\n        console.log(data)\r\n        let paramsToStore = window.DynaConfig.sessionStoreModifiers;\r\n        \r\n        if(!paramsToStore){\r\n            return;\r\n        }\r\n    \r\n        // Retrieve existing stored object or initialize a new one\r\n        let storedData = storage.getItem(\"DoogmaStorageParams\");\r\n        storedData = storedData ? JSON.parse(storedData) : {};\r\n    \r\n        // Ensure 'data' is an object\r\n        if (typeof data === \"object\" && data !== null) {\r\n            console.log(\"1\")\r\n            // Loop through each key-value pair in the provided object\r\n            for (const key in data) {\r\n                if (data.hasOwnProperty(key)) {\r\n                     console.log(\"2\")\r\n                    // Skip undefined keys or values\r\n                    if ( ( key === undefined || data[key] === undefined ) || !paramsToStore.split(\"|\").includes(key) || (data[key]==\"\") ) {\r\n                         console.log(\"3\")\r\n                          console.log(key)\r\n                        // removeKeyFromDoogmaStorage(key)\r\n                        delete storedData[key];\r\n                        continue;\r\n                    }\r\n    \r\n                    // Update or add the key-value pair in storedData\r\n                    storedData[key] = data[key];\r\n                }\r\n            }\r\n    \r\n            // Save the updated object back to storage\r\n            console.log(\"added string\")\r\n            console.log(JSON.stringify(storedData))\r\n            storage.setItem(\"DoogmaStorageParams\", JSON.stringify(storedData));\r\n        }\r\n    }\r\n    \r\n    function removeKeyFromDoogmaStorage(keyToRemove) {\r\n        // Check if localStorage is available; if not, use sessionStorage\r\n        const storage = typeof localStorage !== \"undefined\" ? localStorage : sessionStorage;\r\n      let storedData = localStorage.getItem(\"DoogmaStorageParams\");\r\n    \r\n      if (storedData) {\r\n        try {\r\n          storedData = JSON.parse(storedData);\r\n        } catch (e) {\r\n          console.error(\"Invalid JSON in DoogmaStorageParams\", e);\r\n          return;\r\n        }\r\n    \r\n        console.log(\"Existing keys:\", Object.keys(storedData));\r\n        console.log(\"Key to remove:\", `\"${keyToRemove}\"`);\r\n    \r\n        if (Object.prototype.hasOwnProperty.call(storedData, keyToRemove)) {\r\n          storedData[keyToRemove] = \"test\";\r\n          \r\n          console.log(\"storedData after ket removed\");\r\n          console.log(storedData)\r\n    \r\n          try {\r\n              console.log(JSON.stringify(storedData));\r\n            storage.setItem(\"DoogmaStorageParams\", JSON.stringify(storedData));\r\n            console.log(`Key '${keyToRemove}' removed.`);\r\n          } catch (e) {\r\n            console.error(\"Failed to save updated DoogmaStorageParams\", e);\r\n          }\r\n        } else {\r\n          console.warn(`Key '${keyToRemove}' not found.`);\r\n        }\r\n      } else {\r\n        console.warn(\"DoogmaStorageParams does not exist.\");\r\n      }\r\n    }\r\n    \r\n    function showHideCanvas() {\r\n        const storage = typeof localStorage !== \"undefined\" ? localStorage : sessionStorage;\r\n        var storedData = storage.getItem(\"DoogmaStorageParams\");\r\n        storedData = storedData ? JSON.parse(storedData) : null;\r\n    \r\n        var mainDivs = document.querySelectorAll(\".card-img-container\"); // <-- Use querySelectorAll for multiple\r\n    \r\n        mainDivs.forEach(function(cardContainer) {\r\n            var canvasdiv = cardContainer.querySelector(\".doogma-session-available-wrapper .doogma-session-available\");\r\n            var normalDiv = cardContainer.querySelector(\".doogma-session-available-wrapper .doogma-session-not-available\");\r\n    \r\n            if (storedData && Object.keys(storedData).length > 0) {\r\n                console.log(\"Stored data exists:\", storedData);\r\n                if (canvasdiv) canvasdiv.style.display = \"block\";\r\n                if (normalDiv) normalDiv.style.display = \"none\";\r\n            } else {\r\n                console.log(\"Stored data is null or empty.\");\r\n                if (canvasdiv) canvasdiv.style.display = \"none\";\r\n                if (normalDiv) normalDiv.style.display = \"block\";\r\n            }\r\n        });\r\n    }\r\n\r\n    \r\n    // function removeKeyFromDoogmaStorage(keyToRemove) {\r\n    //     // Retrieve the stored object from localStorage\r\n    //     let storedData = localStorage.getItem(\"DoogmaStorageParams\");\r\n    \r\n    //     // Check if data exists\r\n    //     if (storedData) {\r\n    //         storedData = JSON.parse(storedData); // Convert JSON string to object\r\n    //         console.log(storedData);\r\n    //         console.log(keyToRemove)\r\n    //         console.log(\"All keys in DoogmaStorageParams:\", Object.keys(storedData));\r\n    //         console.log(\"Key to remove:\", `\"${keyToRemove}\"`);\r\n    \r\n    //         // Check if the key exists in the object\r\n    //         if (storedData.hasOwnProperty(keyToRemove)) {\r\n    //             delete storedData[keyToRemove]; // Remove the key from the object\r\n    \r\n    //             // Save the updated object back to localStorage\r\n    //             localStorage.setItem(\"DoogmaStorageParams\", JSON.stringify(storedData));\r\n    //             console.log(`Key '${keyToRemove}' removed from DoogmaStorageParams.`);\r\n    //         } else {\r\n    //             console.log(`Key '${keyToRemove}' does not exist in DoogmaStorageParams.`);\r\n    //         }\r\n    //     } else {\r\n    //         console.log(\"DoogmaStorageParams does not exist in localStorage.\");\r\n    //     }\r\n    // }\r\n    document.addEventListener( \"eventForSessionManagement\", function (event) {\r\n        // alert();\r\n        // console.log(event) \r\n        storeDoogmaParamsInStorage( event.detail );\r\n        \r\n    });\r\n</script>"}
